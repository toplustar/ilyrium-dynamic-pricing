generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Purchase {
  id            String   @id @default(uuid())
  walletAddress String   @map("wallet_address")
  tier          String
  rpsAllocated  Int      @map("rps_allocated")
  price         Float
  duration      Int      @default(30) // days
  createdAt     DateTime @default(now()) @map("created_at")
  expiresAt     DateTime @map("expires_at")
  isActive      Boolean  @default(true) @map("is_active")

  @@map("purchases")
  @@index([walletAddress])
  @@index([isActive])
}

model UsageMetrics {
  id            String   @id @default(uuid())
  walletAddress String   @map("wallet_address")
  requestCount  Int      @default(0) @map("request_count")
  timestamp     DateTime @default(now())
  endpoint      String?

  @@map("usage_metrics")
  @@index([walletAddress])
  @@index([timestamp])
}

model SystemMetrics {
  id          String   @id @default(uuid())
  totalRps    Int      @map("total_rps")
  usedRps     Int      @map("used_rps")
  utilization Float
  timestamp   DateTime @default(now())

  @@map("system_metrics")
  @@index([timestamp])
}

